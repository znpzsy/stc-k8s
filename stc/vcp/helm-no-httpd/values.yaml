global:
  namespace: null

a3gw:
  enabled: true
  replicaCount: 2
  image:
    repository: nexus.telenity.com/com/telenity/consolportals-sa-stc-vcp-a3gw
    tag: 1.0.0.2-amd64
    pullPolicy: IfNotPresent
  env:
    NODE_ENV: production
  sessionAffinity:
    enabled: true
    timeout: 10800
  rollingUpdate:
    maxSurge: 1
    maxUnavailable: 0
  antiAffinity:
    enabled: true
  resources:
    enabled: true
    requests:
      memory: "256Mi"
      cpu: "150m"
    limits:
      memory: "512Mi"
      cpu: "500m"
  probes:
    liveness:
      tcpSocket:
        port: 8444
      initialDelaySeconds: 30
      periodSeconds: 30
      timeoutSeconds: 10
      failureThreshold: 3
    readiness:
      tcpSocket:
        port: 8444
      initialDelaySeconds: 15
      periodSeconds: 10
      timeoutSeconds: 5
      failureThreshold: 3
  pdb:
    enabled: true
    minAvailable: 1
  logging:
    tailSidecar:
      enabled: true
      image: busybox:1.36

adminportal:
  enabled: true
  replicaCount: 2
  image:
    repository: nexus.telenity.com/com/telenity/consolportals-sa-stc-vcp-adminportal
    tag: 1.0.0.2-amd64
    pullPolicy: IfNotPresent
  env:
    NODE_ENV: production
  rollingUpdate:
    maxSurge: 1
    maxUnavailable: 0
  antiAffinity:
    enabled: true
  resources:
    enabled: true
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "400m"
  probes:
    liveness:
      httpGet:
        path: /adminportal
        port: 8080
      initialDelaySeconds: 30
      periodSeconds: 30
      timeoutSeconds: 10
      failureThreshold: 3
    readiness:
      httpGet:
        path: /adminportal
        port: 8080
      initialDelaySeconds: 15
      periodSeconds: 10
      timeoutSeconds: 5
      failureThreshold: 3
  pdb:
    enabled: true
    minAvailable: 1

ccportal:
  enabled: true
  replicaCount: 2
  image:
    repository: nexus.telenity.com/com/telenity/consolportals-sa-stc-vcp-ccportal
    tag: 1.0.0.2-amd64
    pullPolicy: IfNotPresent
  env:
    NODE_ENV: production
  rollingUpdate:
    maxSurge: 1
    maxUnavailable: 0
  antiAffinity:
    enabled: true
  resources:
    enabled: true
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "400m"
  probes:
    liveness:
      httpGet:
        path: /ccportal
        port: 8081
      initialDelaySeconds: 30
      periodSeconds: 30
      timeoutSeconds: 10
      failureThreshold: 3
    readiness:
      httpGet:
        path: /ccportal
        port: 8081
      initialDelaySeconds: 15
      periodSeconds: 10
      timeoutSeconds: 5
      failureThreshold: 3
  pdb:
    enabled: true
    minAvailable: 1

partnerportal:
  enabled: true
  replicaCount: 2
  image:
    repository: nexus.telenity.com/com/telenity/consolportals-sa-stc-vcp-partnerportal
    tag: 1.0.0.2-amd64
    pullPolicy: IfNotPresent
  env:
    NODE_ENV: production
  rollingUpdate:
    maxSurge: 1
    maxUnavailable: 0
  antiAffinity:
    enabled: true
  resources:
    enabled: true
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "400m"
  probes:
    liveness:
      httpGet:
        path: /partnerportal
        port: 8082
      initialDelaySeconds: 30
      periodSeconds: 30
      timeoutSeconds: 10
      failureThreshold: 3
    readiness:
      httpGet:
        path: /partnerportal
        port: 8082
      initialDelaySeconds: 15
      periodSeconds: 10
      timeoutSeconds: 5
      failureThreshold: 3
  pdb:
    enabled: true
    minAvailable: 1

memcached:
  enabled: true
  image:
    repository: memcached
    tag: 1.6-alpine
    pullPolicy: IfNotPresent
  resources:
    requests:
      memory: "64Mi"
      cpu: "50m"
    limits:
      memory: "128Mi"
      cpu: "100m"

service:
  a3gw:
    name: consolportals-sa-stc-vcp-a3gw-service
    type: ClusterIP
    ports:
    - name: portals
      port: 8444
      targetPort: 8444
    - name: auth
      port: 8445
      targetPort: 8445
    selector:
      component: vcp-a3gw
  adminportal:
    name: consolportals-sa-stc-vcp-adminportal-service
    type: ClusterIP
    ports:
    - port: 8080
      targetPort: 8080
    selector:
      component: vcp-adminportal
  partnerportal:
    name: consolportals-sa-stc-vcp-partnerportal-service
    type: ClusterIP
    ports:
    - port: 8082
      targetPort: 8082
    selector:
      component: vcp-partnerportal
  ccportal:
    name: consolportals-sa-stc-vcp-ccportal-service
    type: ClusterIP
    ports:
    - port: 8081
      targetPort: 8081
    selector:
      component: vcp-ccportal

ingress:
  enabled: true
  className: nginx
  host: 'consolportals.internal.telenity.com'
  extraHosts: []
  # Simple routing: everything goes to httpd, which handles proxy logic
  annotations:
    # Cookie-based sticky sessions
    nginx.ingress.kubernetes.io/affinity: "cookie"
    nginx.ingress.kubernetes.io/session-cookie-name: "vcp-sticky"
    nginx.ingress.kubernetes.io/session-cookie-max-age: "10800"  # 3 hours
    nginx.ingress.kubernetes.io/session-cookie-expires: "10800"
    nginx.ingress.kubernetes.io/session-cookie-path: "/"
    nginx.ingress.kubernetes.io/session-cookie-samesite: "Lax"
    nginx.ingress.kubernetes.io/upstream-hash-by: "$cookie_vcp-sticky"
    # request body size and timeout settings for large requests
    nginx.ingress.kubernetes.io/proxy-body-size: "10m"
    nginx.ingress.kubernetes.io/proxy-read-timeout: "300"
    nginx.ingress.kubernetes.io/proxy-send-timeout: "300"

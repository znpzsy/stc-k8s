<div class="modal-header">
    <h4 class="modal-title">
        {{ 'CommonLabels.RBT' | translate }} / {{ 'Subsystems.ContentManagement.Operations.RBT.ContentMetadatas.Tones.Title' | translate }}
    </h4>
</div>

<!--Show Filter / Hide Filter-->
<div class="modal-body buttons-portlet-body">
    <div class="row">
        <div class="col-md-7 col-xs-4">
            <div class="pull-left">
                <div class="btn btn-secondary btn-sm pull-left"
                     title="{{ 'CommonMessages.FilterButtonTitle' | translate }}"
                     ng-model="filterFormLayer.isFilterFormOpen"
                     ng-init="filterFormLayer.isFilterFormOpen = false"
                     ng-click="filterFormLayer.isFilterFormOpen = !filterFormLayer.isFilterFormOpen">
                    <span ng-if="!filterFormLayer.isFilterFormOpen">{{ 'CommonLabels.ShowFilter' | translate }} <i class="fa fa-chevron-circle-right"></i></span>
                    <span ng-if="filterFormLayer.isFilterFormOpen">{{ 'CommonLabels.HideFilter' | translate }} <i class="fa fa-chevron-circle-down"></i></span>
                </div>
            </div>
        </div>

        <div class="col-md-5 col-xs-8">
            <div class="pull-right">
            </div>
        </div>
    </div>
</div>

<!--Filter Form-->
<div class="modal-body">
    <div class="row">
        <div hidden-filter-form ng-model="filterFormLayer" class="col-sm-12 filter-form">

            <form id="filterForm" name="filterForm" method="post" enctype="multipart/form-data" class="form-horizontal parsley-form" novalidate>

                <div class="portlet portlet-boxed">

                    <div class="portlet-body">

                        <div class="col-lg-6 col-md-6 col-sm-12">

                            <!--Status Filter-->
                            <div class="form-group">
                                <label for="status" class="col-md-4 control-label text-right">{{ 'CommonLabels.State' | translate }}</label>
                                <div class="col-md-7">
                                    <select id="status" name="status" class="form-control"
                                            ng-model="dateFilter.status"
                                            ng-options="status as status for status in CMS_RBT_STATUS_TYPES">
                                        <option value="">{{ 'CommonLabels.All' | translate | uppercase}}</option>
                                    </select>
                                </div>
                            </div>

                            <!--Organization Filter-->
                            <div class="form-group">
                                <label for="organizationId" class="col-md-4 control-label text-right">{{ 'CommonLabels.Organization' | translate }}</label>
                                <div class="col-md-7">
                                    <select id= "organizationId" name="organizationId" class="form-control parsley-validated"
                                            ng-model="dateFilter.organizationId"
                                            ng-options="opt.id as opt.name for opt in allOrganizations">
                                        <option value="">-- {{ 'CommonLabels.SelectOne' | translate }} --</option>
                                    </select>
                                </div>
                            </div>

                            <!--Alias Filter-->
                            <div class="form-group">
                                <label for="alias" class="col-md-4 control-label text-right">{{ 'Subsystems.ContentManagement.Operations.RBT.ContentMetadatas.Alias' | translate }}</label>
                                <div class="col-md-7">
                                    <input type="text" class="form-control input-sm" id="alias" name="alias"
                                           ng-model="dateFilter.alias" placeholder="{{ 'Subsystems.ContentManagement.Operations.RBT.ContentMetadatas.AliasPlaceholder' | translate }}"/>
                                </div>
                            </div>

                            <!--Featured Filter-->
                            <div class="form-group">
                                <label class="col-md-4 control-label text-right">{{ 'Subsystems.ContentManagement.Operations.RBT.ContentMetadatas.Promoted' | translate }}</label>
                                <div class="col-md-7">
                                    <div class="btn-group">
                                        <button class="btn {{dateFilter.promoted === undefined || dateFilter.promoted === null?'btn-primary active':'btn-default'}} btn-sm"
                                                ng-disabled="false"
                                                ng-model="dateFilter.promoted" uib-btn-radio="null">{{ 'CommonLabels.All' | translate | humanizeAndTitleize}}</button>
                                        <button class="btn {{dateFilter.promoted === true?'btn-primary active':'btn-default'}} btn-sm"
                                                ng-disabled="false"
                                                ng-model="dateFilter.promoted" uib-btn-radio="true">{{ 'CommonLabels.Yes' | translate }}</button>
                                        <button class="btn {{dateFilter.promoted === false?'btn-primary active':'btn-default'}} btn-sm"
                                                ng-disabled="false"
                                                ng-model="dateFilter.promoted" uib-btn-radio="false">{{ 'CommonLabels.No' | translate }}</button>
                                    </div>
                                </div>
                            </div>

                            <!--Blacklisted Filter-->
                            <div class="form-group">
                                <label class="col-md-4 control-label text-right">{{ 'Subsystems.ContentManagement.Operations.RBT.ContentMetadatas.Blacklisted' | translate }}</label>
                                <div class="col-md-7">
                                    <div class="btn-group">
                                        <button class="btn {{dateFilter.blacklisted === undefined || dateFilter.blacklisted === null?'btn-primary active':'btn-default'}} btn-sm"
                                                ng-disabled="false"
                                                ng-model="dateFilter.blacklisted" uib-btn-radio="null">{{ 'CommonLabels.All' | translate | humanizeAndTitleize }}</button>
                                        <button class="btn {{dateFilter.blacklisted === true?'btn-primary active':'btn-default'}} btn-sm"
                                                ng-disabled="false"
                                                ng-model="dateFilter.blacklisted" uib-btn-radio="true">{{ 'CommonLabels.Yes' | translate }}</button>
                                        <button class="btn {{dateFilter.blacklisted === false?'btn-primary active':'btn-default'}} btn-sm"
                                                ng-disabled="false"
                                                ng-model="dateFilter.blacklisted" uib-btn-radio="false">{{ 'CommonLabels.No' | translate }}</button>
                                    </div>
                                </div>
                            </div>

                            <!--Subscription Filter-->
                            <div class="form-group">
                                <label class="col-md-4 control-label text-right">{{ 'Subsystems.ContentManagement.Operations.RBT.ContentMetadatas.SubscriptionEnabled' | translate }}</label>
                                <div class="col-md-7">
                                    <div class="btn-group">
                                        <button class="btn {{dateFilter.subscriptionEnabled == undefined || dateFilter.subscriptionEnabled == null?'btn-primary active':'btn-default'}} btn-sm"
                                                ng-disabled="false"
                                                ng-model="dateFilter.subscriptionEnabled" uib-btn-radio="null">{{ 'CommonLabels.All' | translate | humanizeAndTitleize}}</button>
                                        <button class="btn {{dateFilter.subscriptionEnabled === true?'btn-primary active':'btn-default'}} btn-sm"
                                                ng-disabled="false"
                                                ng-model="dateFilter.subscriptionEnabled" uib-btn-radio="true">{{ 'CommonLabels.Yes' | translate }}</button>
                                        <button class="btn {{dateFilter.subscriptionEnabled === false?'btn-primary active':'btn-default'}} btn-sm"
                                                ng-disabled="false"
                                                ng-model="dateFilter.subscriptionEnabled" uib-btn-radio="false">{{ 'CommonLabels.No' | translate }}</button>
                                    </div>
                                </div>
                            </div>

                        </div>

                        <div class="col-lg-6 col-md-6 col-sm-12">
                            <!-- Category Search -->
                            <div class="form-group">
                                <label class="col-md-3 control-label text-right">{{ 'Subsystems.ContentManagement.Operations.RBT.ContentMetadatas.ContentInfo.ContentCategory' | translate }}</label>
                                <div class="col-md-7">
                                    <div class="input-group">
                                        <ui-select id="categoryId" name="categoryId" theme="bootstrap" allow-clear="true"
                                                   ng-model="dateFilter.categoryId"
                                                   search-enabled="true"
                                                   close-on-select="true" title="{{ 'CommonLabels.SelectOne' | translate }}">
                                            <ui-select-match placeholder="{{ 'CommonLabels.PleaseWrite' | translate }}">
                                                <span ng-bind="$select.selected.name"></span>
                                            </ui-select-match>
                                            <ui-select-choices repeat="categoryListItem.id as categoryListItem in (contentCategoryList | filter: $select.search) track by categoryListItem.id"
                                                               refresh="searchCategories($select.search)"
                                                               refresh-delay="0">
                                                <div ng-bind-html="categoryListItem.name | highlight: $select.search"></div>
                                                <small>
                                                    Organization: {{(categoryListItem.organizationName ? categoryListItem.organizationName : 'N/A')}}
                                                </small>
                                            </ui-select-choices>
                                        </ui-select>
                                        <span class="input-group-btn">
                                        <button type="button" ng-click="dateFilter.categoryId = null;" class="btn btn-default">
                                            <span class="fa fa-times"></span>
                                        </button>
                                    </span>
                                    </div>
                                </div>
                            </div>

                            <!-- Subcategory Search -->
                            <div class="form-group">
                                <label class="col-md-3 control-label text-right">{{ 'Subsystems.ContentManagement.Operations.RBT.ContentMetadatas.ContentInfo.ContentSubcategory' | translate }}</label>
                                <div class="col-md-7">
                                    <div class="input-group">
                                        <ui-select id="subcategory" name="subcategory" theme="bootstrap" allow-clear="true"
                                                   ng-model="dateFilter.subcategory"
                                                   ng-disabled="!dateFilter.categoryId"
                                                   search-enabled="true"
                                                   close-on-select="true" title="{{ 'CommonLabels.SelectOne' | translate }}">
                                            <ui-select-match placeholder="{{ 'CommonLabels.PleaseWrite' | translate }}">
                                                <span ng-bind="$select.selected.name"></span>
                                            </ui-select-match>
                                            <ui-select-choices repeat="contentSubcategoryListItem.id as contentSubcategoryListItem in (contentSubcategoryList | filter: $select.search) track by contentSubcategoryListItem.id"
                                                               refresh="searchSubcategories($select.search, dateFilter.categoryId)"
                                                               refresh-delay="0">
                                                <div ng-bind-html="contentSubcategoryListItem.name | highlight: $select.search"></div>
                                                <small>
                                                    Organization: {{(contentSubcategoryListItem.organizationName ? contentSubcategoryListItem.organizationName : 'N/A')}}
                                                </small>
                                            </ui-select-choices>
                                        </ui-select>
                                        <span class="input-group-btn">
                                            <button type="button" ng-click="dateFilter.subcategory = null;" class="btn btn-default">
                                                <span class="fa fa-times"></span>
                                            </button>
                                        </span>
                                    </div>
                                </div>
                            </div>

                            <!-- Artist Search -->
                            <div class="form-group">
                                <label class="col-md-3 control-label text-right">{{ 'Subsystems.ContentManagement.Operations.RBT.ContentMetadatas.ContentInfo.ContentArtist' | translate }}</label>
                                <div class="col-md-7">
                                    <div class="input-group">
                                        <ui-select id="artistId" name="artistId" theme="bootstrap" allow-clear="true"
                                                   ng-model="dateFilter.artistId"
                                                   search-enabled="true"
                                                   close-on-select="true" title="{{ 'CommonLabels.SelectOne' | translate }}">
                                            <ui-select-match placeholder="{{ 'CommonLabels.PleaseWrite' | translate }}">
                                                <span ng-bind="$select.selected.name"></span>
                                            </ui-select-match>
                                            <ui-select-choices repeat="artistListItem.id as artistListItem in (artistList | filter: $select.search) track by artistListItem.id"
                                                               refresh="searchArtists($select.search)"
                                                               refresh-delay="0">
                                                <div ng-bind-html="artistListItem.name | highlight: $select.search"></div>
                                                <small>
                                                    Organization: {{(artistListItem.organizationName ? artistListItem.organizationName : 'N/A')}}
                                                </small>
                                            </ui-select-choices>
                                        </ui-select>
                                        <span class="input-group-btn">
                                            <button type="button" ng-click="dateFilter.artistId = null;" class="btn btn-default">
                                                <span class="fa fa-times"></span>
                                            </button>
                                        </span>
                                    </div>
                                </div>
                            </div>

                            <!--Search Button-->
                            <div class="form-group">
                                <label class="col-md-3 control-label text-right">&nbsp;</label>
                                <div class="col-md-7">
                                    <button class="btn btn-sm btn-secondary" ng-disabled="filterForm.$invalid"
                                            ng-click="throttledReloadTable();"><i class="fa fa-search"></i>
                                        {{'CommonLabels.Search' | translate }}
                                    </button>
                                </div>
                            </div>
                        </div>

                    </div>

                </div>

            </form>

        </div>
    </div>
</div>

<!--Search With Name-->
<div class="modal-body buttons-portlet-body" ng-show="contentMetadataList.showTable">
    <div class="row">

        <div class="col-md-8 col-sm-6 col-xs-8">
            <span ng-if="selectedTone.name">
                <div class="modal-option-selection">
                    <span ng-if="selectedTone.alias" class="label label-warning">{{selectedTone.alias}} </span>
                    <span class="label label-info">{{selectedTone.organizationName}} </span>
                    <span class="label label-success">{{selectedTone.name}}&nbsp;&nbsp;<a
                            href="javascript:;" ng-click="removeSelection();"><i
                            class="fa fa-times-circle"></i></a></span>
                </div>
            </span>
            <span ng-if="!selectedTone || !selectedTone.name">
                {{ 'CommonMessages.SelectTableRecord' | translate }}
            </span>
        </div>

        <div class="col-md-4 col-sm-6 col-xs-4">
            <form class="mainnav-form">
                <input type="text" class="form-control input-sm pull-right mainnav-search-query"
                       ng-model="filterText" ng-change="filterTable(filterText, ['name'])"
                       placeholder="{{ 'Services.RBT.Operations.PressKey.Management.SearchByToneTitle' | translate }}...">
                <button class="btn btn-sm mainnav-form-btn"><i class="fa fa-search"></i></button>
            </form>
        </div>
    </div>
</div>

<!-- Data Table -->
<div class="modal-body" ng-show="contentMetadataList.showTable">
    <div class="row">
        <div class="col-sm-12">
            <div class="table-responsive">
                <table ng-table="contentMetadataList.tableParams" class="table table-striped table-bordered"
                       template-pagination="ngTableCustomPager.html"
                       export-csv="csv" export-xls="xls"
                       export-options="exportOptions">
                    <tr ng-repeat="data in $data track by $index" class="hidden-link-cell-row"
                        ng-class="{ 'row-selected': selectedTone.id === data.id }"
                        ng-click="toneSelected(data)">
                        <!--<td align="center" data-title="'Subsystems.ContentManagement.Operations.RBT.ChargingDetails.SubscriptionCode' | translate" >{{data.offers[0].subscriptionCode || 'TBD'}}</td>-->
                        <td align="center" class="wrap" data-title="'Subsystems.ContentManagement.Operations.RBT.ContentMetadatas.Alias' | translate" sortable="'alias'">{{data.alias}}</td>
                        <td align="center" class="wrap" data-title="'Subsystems.ContentManagement.Operations.RBT.ContentMetadatas.Tones.Name' | translate" sortable="'name'"
                            uib-tooltip="{{data.name}}" tooltip-class="custom-class"  tooltip-placement="top" tooltip-animation="false" tooltip-trigger="'mouseenter'" tooltip-append-to-body="true">{{data.name}}</td>
                        <td align="center" class="wrap" data-title="'CommonLabels.Organization' | translate" sortable="'organizationName'"
                            uib-tooltip="{{data.organizationName}}" tooltip-class="custom-class"  tooltip-placement="top" tooltip-animation="false" tooltip-trigger="'mouseenter'" tooltip-append-to-body="true">{{data.organizationName}}</td>
                        <td align="center" class="nowrap-fixedwidth width-105" data-title="'CommonLabels.State' | translate">{{data.status}}
                            <span ng-if="data.status == 'REJECTED' && data.rejectReason" class="fa fa-question-circle"
                                  uib-tooltip="{{data.rejectReason}}"
                                  tooltip-placement="top"
                                  style="margin-left: 6px; cursor: pointer;"></span>
                        </td>
                        <td align="center" class="nowrap-fixedwidth width-30" data-title="'Subsystems.ContentManagement.Operations.RBT.ContentMetadatas.Promoted' | translate">{{data.promoted | YesNoFilter}}</td>
                        <td align="center" class="nowrap-fixedwidth width-30" data-title="'Subsystems.ContentManagement.Operations.RBT.ContentMetadatas.Blacklisted' | translate">{{data.isBlacklisted | YesNoFilter}}</td>
                        <td align="center" class="nowrap-fixedwidth width-30" data-title="'Subsystems.ContentManagement.Operations.RBT.ContentMetadatas.SubscriptionEnabled' | translate">{{data.subscriptionEnabled | YesNoFilter}}</td>
                        <td align="center" class="action-column" data-title="'Services.RBT.Operations.PressKey.Management.TableColumns.ToneAudio' | translate">
                            <button ng-if="data.toneFileId"
                                    ng-click="playAudio($index, data.toneFileId)"
                                    class="btn btn-xs {{audio.canDisplayButton($index, data.toneFileId, 'stop') ? 'btn-danger' : 'btn-secondary btn-inverse'}}"
                                    title="{{ audio.getLabel($index,data.toneFileId) | translate }}">
                                <i class="fa fa-play-circle"
                                   ng-if="audio.canDisplayButton($index, data.toneFileId, 'play')"></i>
                                <i class="fa fa-spinner fa-spin"
                                   ng-if="audio.canDisplayButton($index, data.toneFileId, 'spinner')"></i>
                                <i class="fa fa-stop-circle"
                                   ng-if="audio.canDisplayButton($index, data.toneFileId, 'stop')"></i>
                            </button>
                        </td>
                    </tr>
                    <tr ng-if="!$data || $data.length === 0">
                        <td colspan="9" class="text-center">{{ 'CommonMessages.EmptyTable' | translate }}</td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="modal-footer">
    <button class="btn btn-primary" ng-click="ok()">{{'CommonLabels.Save' | translate}}</button>
    <button class="btn btn-default" ng-click="cancel()">{{'CommonLabels.Cancel' | translate}}</button>
</div>
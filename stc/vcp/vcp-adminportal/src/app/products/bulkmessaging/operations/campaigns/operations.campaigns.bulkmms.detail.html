<div class="portlet-body" ng-show="!isBulkMmsUser">
    <h5>
        <span class="col-md-12 text-center alert alert-warning">{{ 'CommonMessages.NotBulkMMSUser' | translate }}</span>
    </h5>
</div>

<div class="portlet-body" ng-show="isBulkMmsUser">

    <form class="form-horizontal parsley-form" novalidate id="campaignForm" name="form" method="post" enctype="multipart/form-data">

        <div class="form-group">
            <label class="col-md-3">{{ 'Products.BulkMessaging.Operations.Campaigns.Fields.CampaignName' | translate }}</label>
            <div class="col-md-7">
                <input name="campaignName" type="text" class="form-control" ng-model="campaign.campaignName"
                       ng-disabled="!AuthorizationService.canBmsOperationsCampaignCreate()"
                       ng-required="true" maxlength="512" ng-maxlength="512"/>
                <ul ng-class="{ 'parsley-error-list': form.campaignName.$dirty && form.campaignName.$invalid }"
                    ng-show="form.campaignName.$dirty && form.campaignName.$invalid">
                    <li class="required" ng-show="form.campaignName.$error.required">{{ 'CommonMessages.RequiredFieldError' | translate }}</li>
                    <li class="required" ng-show="form.campaignName.$error.maxlength">{{ 'CommonMessages.MaxLengthError' | translate:{ max_length: 512 } }}</li>
                </ul>
            </div>
        </div>

        <div class="form-group">
            <label class="col-md-3">{{ 'Products.BulkMessaging.Operations.Campaigns.Fields.CampaignStartDateTime' | translate }}</label>
            <div class="col-md-3">
                <p class="input-group datepicker-field">
                    <input type="text" class="form-control input-sm" id="startDate" name="startDate"
                           uib-datepicker-popup="{{dateFormat}}" ng-model="dateHolder.startDate"
                           ng-disabled="!AuthorizationService.canBmsOperationsCampaignCreate()"
                           is-open="startDatePicker.opened" close-text="Close"
                           datepicker-options="dateOptions" ng-required="true"
                           ng-change="updateStartDate(dateHolder.startDate)"/>
                    <span class="input-group-btn">
                        <button type="button" class="btn btn-default input-sm"
                                ng-click="openStartDatePicker($event)"><i
                                class="fa fa-calendar"></i></button>
                    </span>
                    <ul ng-class="{ 'parsley-error-list': form.startDate.$dirty && form.startDate.$invalid }"
                        ng-show="form.startDate.$dirty && form.startDate.$invalid">
                        <li class="required" ng-show="form.startDate.$error.required">{{ 'CommonMessages.RequiredFieldError' | translate }}</li>
                        <li class="required" ng-show="form.startDate.$error.parse">{{ 'GenericFormFields.StartDate.Messages.Invalid' | translate }}</li>
                    </ul>
                </p>
            </div>
            <div class="col-md-4 row">
                <span class="time-picker with-date-picker">
                    <div uib-timepicker ng-model="dateHolder.startTime" hour-step="hstep" minute-step="mstep"
                         show-meridian="false" readonly-input="true" mousewheel="false" ng-disabled="!AuthorizationService.canBmsOperationsCampaignCreate()"
                         ng-change="updateStartDateTime(dateHolder.startTime)"></div>
                </span>
            </div>
        </div>

        <div class="form-group">
            <div class="col-md-10">
                <div class="divider"></div>
            </div>
        </div>

        <div class="settings-expander">
            <a id="extra-settings-expander" class="link" href="javascript:;" ng-click="showExtraSettings = !showExtraSettings;">
                {{ (showExtraSettings ? 'CommonLabels.HideExtraSettings' : 'CommonLabels.ShowExtraSettings') | translate }}
            </a>
        </div>

        <!-- Extra form fields -->
        <span ng-if="showExtraSettings">
            <div class="form-group">
                <label class="col-md-3">{{ 'Products.BulkMessaging.Operations.Campaigns.Fields.ForceExpiryDate' | translate }}</label>
                <div class="col-md-7">
                    <div class="btn-group">
                        <button type="button" class="btn {{campaign.forceExpiryDate ?'btn-primary active':'btn-default'}} btn-sm"
                                ng-model="campaign.forceExpiryDate" ng-disabled="!AuthorizationService.canBmsOperationsCampaignCreate()" uib-btn-radio="true">{{ 'CommonLabels.Yes' | translate }}</button>
                        <button type="button" class="btn {{!campaign.forceExpiryDate ?'btn-primary active':'btn-default'}} btn-sm"
                                ng-model="campaign.forceExpiryDate" ng-disabled="!AuthorizationService.canBmsOperationsCampaignCreate()" uib-btn-radio="false">{{ 'CommonLabels.No' | translate }}</button>
                    </div>
                </div>
            </div>

            <div class="form-group" ng-if="campaign.forceExpiryDate">
                <label class="col-md-3">{{ 'Products.BulkMessaging.Operations.Campaigns.Fields.CampaignExpiryDateTime' | translate }}</label>
                <div class="col-md-3">
                    <p class="input-group datepicker-field">
                        <input type="text" class="form-control input-sm" id="endDate" name="endDate"
                               uib-datepicker-popup="{{dateFormat}}" ng-model="dateHolder.endDate"
                               ng-disabled="!AuthorizationService.canBmsOperationsCampaignCreate()"
                               is-open="endDatePicker.opened" close-text="Close"
                               datepicker-options="dateOptions" ng-required="true"
                               ng-change="updateEndDate(dateHolder.endDate)"/>
                        <span class="input-group-btn">
                            <button type="button" class="btn btn-default input-sm"
                                    ng-click="openEndDatePicker($event)"><i
                                    class="fa fa-calendar"></i></button>
                        </span>
                        <ul ng-class="{ 'parsley-error-list': form.endDate.$dirty && form.endDate.$invalid }"
                            ng-show="form.endDate.$dirty && form.endDate.$invalid">
                            <li class="required" ng-show="form.endDate.$error.required">{{ 'CommonMessages.RequiredFieldError' | translate }}</li>
                            <li class="required" ng-show="form.endDate.$error.parse">{{ 'GenericFormFields.EndDate.Messages.Invalid' | translate }}</li>
                        </ul>
                    </p>
                </div>
                <div class="col-md-4 row">
                    <span class="time-picker with-date-picker">
                        <div uib-timepicker ng-model="dateHolder.endTime" hour-step="hstep" minute-step="mstep"
                             show-meridian="false" readonly-input="true" mousewheel="false" ng-disabled="!AuthorizationService.canBmsOperationsCampaignCreate()"
                             ng-change="updateEndDateTime(dateHolder.endTime)"></div>
                    </span>
                </div>
            </div>

            <!-- Screening Lists -->
            <div class="form-group" ng-if="blackListEnabled">
                <label class="col-md-3">{{ 'Products.BulkMessaging.Operations.Campaigns.EnforceScreening' | translate}}</label>
                <div class="col-md-7">
                    <div class="btn-group">
                        <button class="btn {{bulkMMSPolicyProfile.isScreeningListsEnforced?'btn-primary active':'btn-default'}} btn-sm"
                                ng-disabled="!AuthorizationService.canBmsOperationsCampaignCreate()"
                                ng-model="bulkMMSPolicyProfile.isScreeningListsEnforced" uib-btn-radio="true">{{ 'CommonLabels.Yes' | translate }}</button>
                        <button class="btn {{!bulkMMSPolicyProfile.isScreeningListsEnforced?'btn-primary active':'btn-default'}} btn-sm"
                                ng-disabled="!AuthorizationService.canBmsOperationsCampaignCreate()"
                                ng-model="bulkMMSPolicyProfile.isScreeningListsEnforced" uib-btn-radio="false">{{ 'CommonLabels.No' | translate }}</button>
                    </div>
                </div>
            </div>

            <div class="form-group" ng-if="blackListEnabled && bulkMMSPolicyProfile.isScreeningListsEnforced">
                <label class="col-md-3">{{ 'Products.BulkMessaging.Operations.Campaigns.ScreeningLists' | translate}}</label>
                <div class="col-md-7">
                    <div ng-if="campaign.campaignBlackLists.length" class="row col-md-9">
                        <div ng-repeat="campaignBlackList in campaign.campaignBlackLists">
                            <span class="label label-default selected-item-label">
                                {{ campaignBlackList.name | limitTo:40 }}{{ campaignBlackList.name.length > 40 ? '...' : '' }}
                            </span>&nbsp;
                            <a ng-click="removeBlackList(campaign, campaignBlackList)"
                               style="cursor: pointer;text-decoration: none;">
                                <span class="label label-danger" ng-if="AuthorizationService.canBmsOperationsCampaignCreate()"><i
                                        class="fa fa-times"></i></span>
                            </a>
                        </div>
                    </div>
                    <button class="btn btn-default col-md-3"
                            ng-class="{ 'pull-right': bulkMMSPolicyProfile.ScreeningLists.length }"
                            ng-click="addBlackList(campaign, campaign.campaignBlackLists)"
                            ng-disabled="!AuthorizationService.canBmsOperationsCampaignCreate()">{{ 'CommonLabels.Add' | translate }}</button>
                </div>
            </div>

            <!-- Time Restrictions -->
            <div class="form-group">
                <label class="col-md-3">{{ 'Products.BulkMessaging.Operations.Campaigns.EnforceTimeConstraints' | translate}}</label>
                <div class="col-md-7">
                    <div class="btn-group">
                        <button class="btn {{bulkMMSPolicyProfile.isTimeConstraintEnforced?'btn-primary active':'btn-default'}} btn-sm"
                                ng-disabled="!AuthorizationService.canBmsOperationsCampaignCreate()"
                                ng-model="bulkMMSPolicyProfile.isTimeConstraintEnforced" uib-btn-radio="true">{{ 'CommonLabels.Yes' | translate }}</button>
                        <button class="btn {{!bulkMMSPolicyProfile.isTimeConstraintEnforced?'btn-primary active':'btn-default'}} btn-sm"
                                ng-disabled="!AuthorizationService.canBmsOperationsCampaignCreate()"
                                ng-model="bulkMMSPolicyProfile.isTimeConstraintEnforced" uib-btn-radio="false">{{ 'CommonLabels.No' | translate }}</button>
                    </div>
                </div>
            </div>

            <div class="form-group" ng-if="bulkMMSPolicyProfile.isTimeConstraintEnforced">
                <label class="col-md-3">{{ 'Products.BulkMessaging.Operations.Campaigns.TimeConstraints' | translate}}</label>
                <div class="col-md-7">
                    <div ng-if="bulkMMSPolicyProfile.TimeConstraints.length" class="row col-md-9">
                        <div ng-repeat="timeConstraint in bulkMMSPolicyProfile.TimeConstraints">
                            <span class="label label-default selected-item-label">
                                {{ timeConstraint.value | TimeConstraintViewFilter }}
                            </span>&nbsp;
                            <a ng-click="addUpdateTimeConstraint(campaign, bulkMMSPolicyProfile, timeConstraint)" style="cursor: pointer;text-decoration: none;">
                                <span class="label label-secondary" ng-if="AuthorizationService.canBmsOperationsCampaignCreate()"><i class="fa fa-edit"></i></span>
                            </a>
                            <a ng-click="removeTimeConstraint(bulkMMSPolicyProfile, timeConstraint)" style="cursor: pointer;text-decoration: none;">
                                <span class="label label-danger" ng-if="AuthorizationService.canBmsOperationsCampaignCreate()"><i class="fa fa-times"></i></span>
                            </a>
                        </div>
                    </div>
                    <button class="btn btn-default col-md-3"
                            ng-class="{ 'pull-right': bulkMMSPolicyProfile.TimeConstraints.length }"
                            ng-click="addUpdateTimeConstraint(campaign, bulkMMSPolicyProfile)"
                            ng-disabled="!AuthorizationService.canBmsOperationsCampaignCreate()">{{ 'CommonLabels.Add' | translate }}</button>
                </div>
            </div>

            <!-- Allow Off Net Delivery -->
            <div class="form-group">
                <label class="col-md-3">{{ 'Products.BulkMessaging.Operations.Campaigns.AllowOffNetDelivery' | translate}}</label>
                <div class="col-md-7">
                    <div class="btn-group">
                        <button class="btn {{bulkMMSPolicyProfile.isOffNetDeliveryAllowed?'btn-primary active':'btn-default'}} btn-sm"
                                ng-disabled="true"
                                ng-model="bulkMMSPolicyProfile.isOffNetDeliveryAllowed" uib-btn-radio="true">{{ 'CommonLabels.Yes' | translate }}</button>
                        <button class="btn {{!bulkMMSPolicyProfile.isOffNetDeliveryAllowed?'btn-primary active':'btn-default'}} btn-sm"
                                ng-disabled="true"
                                ng-model="bulkMMSPolicyProfile.isOffNetDeliveryAllowed" uib-btn-radio="false">{{ 'CommonLabels.No' | translate }}</button>
                    </div>
                </div>
            </div>

            <!-- Allow Forward Tracking -->
            <!-- TODO - Temporarily hidden -->
            <div class="form-group" ng-if="false">
                <label class="col-md-3">{{ 'Products.BulkMessaging.Operations.Campaigns.AllowForwardTracking' | translate}}</label>
                <div class="col-md-7">
                    <div class="btn-group">
                        <button class="btn {{bulkMMSPolicyProfile.isForwardTrackingAllowed?'btn-primary active':'btn-default'}} btn-sm"
                                ng-disabled="!AuthorizationService.canBmsOperationsCampaignCreate()"
                                ng-model="bulkMMSPolicyProfile.isForwardTrackingAllowed" uib-btn-radio="true">{{ 'CommonLabels.Yes' | translate }}</button>
                        <button class="btn {{!bulkMMSPolicyProfile.isForwardTrackingAllowed?'btn-primary active':'btn-default'}} btn-sm"
                                ng-disabled="!AuthorizationService.canBmsOperationsCampaignCreate()"
                                ng-model="bulkMMSPolicyProfile.isForwardTrackingAllowed" uib-btn-radio="false">{{ 'CommonLabels.No' | translate }}</button>
                    </div>
                </div>
            </div>

            <!-- Disable Charging -->
            <div class="form-group">
                <label class="col-md-3">{{ 'Products.BulkMessaging.Operations.Campaigns.DisableCharging' | translate}}</label>
                <div class="col-md-7">
                    <div class="btn-group">
                        <button class="btn {{bulkMMSPolicyProfile.isDisableChargingAllowed?'btn-primary active':'btn-default'}} btn-sm"
                                ng-disabled="!AuthorizationService.canBmsOperationsCampaignCreate()"
                                ng-model="bulkMMSPolicyProfile.isDisableChargingAllowed" uib-btn-radio="true">{{ 'CommonLabels.Yes' | translate }}</button>
                        <button class="btn {{!bulkMMSPolicyProfile.isDisableChargingAllowed?'btn-primary active':'btn-default'}} btn-sm"
                                ng-disabled="!AuthorizationService.canBmsOperationsCampaignCreate()"
                                ng-model="bulkMMSPolicyProfile.isDisableChargingAllowed" uib-btn-radio="false">{{ 'CommonLabels.No' | translate }}</button>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label class="col-md-3">{{ 'Products.BulkMessaging.Operations.Campaigns.Fields.MaxRetryCount' | translate }}</label>
                <div class="col-md-3">
                    <input id="maxRetryCount" name="maxRetryCount" type="number" class="form-control"
                           ng-model="campaign.maxRetryCount"
                           min="0" max="{{maxMaxRetryCount}}" ng-required="true"
                           ng-disabled="!AuthorizationService.canBmsOperationsCampaignCreate()"/>
                    <ul ng-class="{ 'parsley-error-list': form.maxRetryCount.$dirty && form.maxRetryCount.$invalid }"
                        ng-show="form.maxRetryCount.$dirty && form.maxRetryCount.$invalid">
                        <li class="required" ng-show="form.maxRetryCount.$error.min">{{ 'CommonMessages.MinValueError' | translate:{min: 0} }}</li>
                        <li class="required" ng-show="form.maxRetryCount.$error.max">{{ 'CommonMessages.MaxValueError' | translate:{max: maxMaxRetryCount} }}</li>
                        <li class="required" ng-show="form.maxRetryCount.$error.required">{{ 'CommonMessages.RequiredFieldError' | translate }}</li>
                        <li class="required" ng-show="form.maxRetryCount.$error.number">{{ 'CommonMessages.NumericFieldError' | translate }}</li>
                    </ul>
                </div>
            </div>
        </span>

        <div class="form-group">
            <div class="col-md-10">
                <div class="divider"></div>
            </div>
        </div>

        <div class="form-group">
            <label class="col-md-3">{{ 'Products.BulkMessaging.Operations.Campaigns.Fields.From' | translate }}</label>
            <div class="col-md-7" ng-if="bulkMMSPolicyProfile.isAlphanumericSenderListRestricted">
                <select id="from" name="from" class="form-control parsley-validated" ng-model="campaign.from"
                        ng-required="true" ng-disabled="!AuthorizationService.canBmsOperationsCampaignCreate()"
                        ng-options="permissibleAlphanumericSender.value as permissibleAlphanumericSender.value for permissibleAlphanumericSender in bulkMMSPolicyProfile.PermissibleAlphanumericSenders">
                    <option value="">-- {{ 'CommonLabels.SelectOne' | translate }} --</option>
                </select>
                <ul ng-class="{ 'parsley-error-list': form.from.$dirty && form.from.$invalid }" ng-show="form.from.$dirty && form.from.$invalid">
                    <li class="required" ng-show="form.from.$error.required">{{ 'CommonMessages.RequiredFieldError' | translate }}</li>
                </ul>
            </div>
            <div class="col-md-7" ng-if="!bulkMMSPolicyProfile.isAlphanumericSenderListRestricted">
                <input name="from" type="text" class="form-control" ng-value="bulkMMSPolicyProfile.ChargingMsisdn" ng-disabled="true"/>
            </div>
        </div>

        <div class="form-group">
            <label class="col-md-3">{{ 'Products.BulkMessaging.Operations.Campaigns.Fields.ListType' | translate }}</label>
            <div class="col-md-7">
                <select id="listType" name="listType" class="form-control parsley-validated" ng-model="listType"
                        ng-required="true" ng-disabled="!AuthorizationService.canBmsOperationsCampaignCreate()"
                        ng-options="listType.key as (listType.textKey | translate | uppercase) for listType in BMS_DISTRIBUTION_LIST_TYPES">
                    <option value="">-- {{ 'CommonLabels.SelectOne' | translate }} --</option>
                </select>
                <ul ng-class="{ 'parsley-error-list': form.listType.$dirty && form.listType.$invalid }" ng-show="form.listType.$dirty && form.listType.$invalid">
                    <li class="required" ng-show="form.listType.$error.required">{{ 'CommonMessages.RequiredFieldError' | translate }}</li>
                </ul>
            </div>
        </div>

        <div class="form-group">
            <label class="col-md-3">{{ 'Products.BulkMessaging.Operations.Campaigns.Fields.To' | translate }}</label>
            <div class="col-md-7">
                <select id="to" name="to" class="form-control parsley-validated" ng-model="campaign.to"
                        ng-required="true" ng-disabled="!AuthorizationService.canBmsOperationsCampaignCreate()"
                        ng-options="distributionList.id as (distributionList.name + ' (' + distributionList.listSize + ')') for distributionList in (distributionListArray | DistributionListByListTypeFilter:listType)">
                    <option value="">-- {{ 'CommonLabels.SelectOne' | translate }} --</option>
                </select>
                <ul ng-class="{ 'parsley-error-list': form.to.$dirty && form.to.$invalid }" ng-show="form.to.$dirty && form.to.$invalid">
                    <li class="required" ng-show="form.to.$error.required">{{ 'CommonMessages.RequiredFieldError' | translate }}</li>
                </ul>
            </div>
        </div>

        <div class="row">
            <div class="col-md-10">
                <h5 class="portlet-title">
                    {{ 'Products.BulkMessaging.BulkMMS.MMSComposer' | translate }}
                </h5>
            </div>
        </div>

        <div class="row">
            <div class="col-md-10">
                <div class="col-md-12 slick-preview">
                    <div class="panel center-block" style="height: 30px; -webkit-box-shadow: none;; box-shadow: none;">
                        <div class="add-new-slide-button btn-group pull-left" role="group">
                            <button type="button" class="btn btn-secondary btn-sm" ng-click="addNewSlide()"
                                    ng-disabled="!isAllowingNewPage()">
                                <i class="fa fa-plus"></i> {{ 'Products.BulkMessaging.Composer.NewPage' | translate }}
                            </button>
                        </div>
                        <div class="pull-right">
                            {{ 'Products.BulkMessaging.Composer.TotalPageCount' | translate }}: {{currentSlick1.slideCount}}
                        </div>
                    </div>

                    <div class="panel panel-default center-block" style="height: 445px;">
                        <slick settings="slickViewer" class="slider-for">
                            <div ng-repeat="i in []">
                            </div>
                        </slick>
                    </div>

                    <div class="center-block" style="text-align: center;height: 35px;">
                        <div style="margin-top: 5px; height: 25px; -webkit-box-shadow: none;; box-shadow: none;display: inline-block;">
                            <button type="button" class="btn btn-default btn-sm" ng-click="pauseSlide();" ng-if="slidePlaying"><i class="fa fa-pause" aria-hidden="true"></i></button>
                            <div class="btn-group center-block" role="group" ng-if="currentSlick1.slideCount > 0 && !slidePlaying">
                                <button type="button" class="btn btn-default btn-sm" ng-click="slickViewer.method.slickPrev()"><i class="fa fa-chevron-left" aria-hidden="true"></i></button>
                                <button type="button" class="btn btn-default btn-sm" ng-click="playSlide();" style="width: 33px;"><i class="fa fa-play" aria-hidden="true"></i></button>
                                <button type="button" class="btn btn-default btn-sm" ng-click="slickViewer.method.slickNext()"><i class="fa fa-chevron-right" aria-hidden="true"></i></button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-12" style="z-index: 1039;margin-bottom: 15px;">
                    <slick settings="slickNavigator" class="slider-nav center-block">
                        <div ng-repeat="i in []">
                        </div>
                    </slick>
                </div>
            </div>
        </div>

        <div class="form-group">
            <div class="col-md-10">
                <div class="divider"></div>
            </div>
        </div>

        <div class="form-group">
            <div class="col-md-6 col-md-push-3">
                <button type="submit" class="btn btn-danger"
                        ng-disabled="form.$invalid || !AuthorizationService.canBmsOperationsCampaignCreate() || (currentSlick1.$slides.length === 0)"
                        ng-click="start(campaign, dateHolder, bulkMMSPolicyProfile);">
                    {{ 'CommonLabels.Submit' | translate }}
                </button>
                <button class="btn btn-default" ng-click="cancel();">
                    {{ 'CommonLabels.Cancel' | translate }}
                </button>
            </div>
        </div>

    </form>

</div>

<div class="form-group" ng-if="channels">
    <label for="channel" class="col-md-3">{{ 'Subsystems.Reporting.Channel' | translate }}</label>
    <div class="col-md-3">
        <select id="channel" name="channel" class="form-control parsley-validated" ng-model="$parent.channel"
                ng-change="changeMsggwChannel($parent.channel);"
                ng-options="channel as channel for channel in channels">
        </select>
    </div>
</div>

<div class="form-group" ng-if="REPORTING_BMS_CHANNELS">
    <label for="channel" class="col-md-3">{{ 'Subsystems.Reporting.CampaignType' | translate }}</label>
    <div class="col-md-4">
        <select id="channel" name="channel" class="form-control parsley-validated" ng-model="$parent.channel"
                ng-change="changeBMSChannel($parent.channel);"
                ng-options="channel as channel for channel in REPORTING_BMS_CHANNELS">
        </select>
    </div>
</div>

<div class="form-group">
    <label for="reportCategory" class="col-md-3">{{ 'Subsystems.Reporting.Category' | translate }}</label>
    <div class="col-md-9">
        <select id="reportCategory" name="reportCategory" class="form-control parsley-validated"
                ng-model="$parent.reportCategory"
                ng-options="report as report.label group by report.group for report in REPORTS"
                ng-init="changeReportCategory($parent.reportCategory);"
                ng-change="changeReportCategory($parent.reportCategory);">
        </select>
    </div>
</div>

<!-- Show the template selection for only on demand report pages. -->
<!-- Report Template -->
<div class="form-group" ng-if="$state.includes($state.current.data.onDemandState) && reportTemplateList.length > 0">
    <label for="reportTemplate" class="col-md-3">{{ 'Subsystems.Reporting.ReportTemplate.Title' | translate }}</label>
    <div class="col-md-6">
        <div class="input-group">
            <ui-select theme="bootstrap" allow-clear="true" append-to-body="true"
                       ng-model="$parent.$parent.$parent.reportTemplate"
                       on-select="applyReportTemplate($parent.$parent.$parent.reportTemplate); form.reportTemplate.$setDirty();"
                       ng-disabled="!AuthorizationService.canAllReportsOnDemandRead()">
                <ui-select-match placeholder="{{ 'CommonLabels.SelectOne' | translate }}">
                    <span ng-bind="$select.selected.TemplateName"></span>
                </ui-select-match>
                <ui-select-choices repeat="reportTemplateItem as reportTemplateItem in (reportTemplateList | filter: $select.search) track by reportTemplateItem.TemplateName">
                    <div ng-bind-html="reportTemplateItem.TemplateName | highlight: $select.search"></div>
                </ui-select-choices>
            </ui-select>
            <span class="input-group-btn">
                <button type="button" ng-click="$parent.$parent.reportTemplate = null;" class="btn btn-default">
                    <span class="fa fa-times"></span>
                </button>
            </span>
        </div>
    </div>
    <div class="col-md-2">
        <div class="btn-group">
            <button type="button" class="btn btn-default"
                    uib-tooltip="{{ 'CommonLabels.Update' | translate }}" tooltip-placement="top" tooltip-animation="false" tooltip-trigger="'mouseenter'" tooltip-append-to-body="true"
                    ng-disabled="reportTemplate === null || isUpdated()"
                    ng-click="updateReportTemplate(reportTemplate, reportCategory, interval, formatPentaho, dateHolder, permanentParams, additionalParams);">
                <span class="fa fa-save"></span>
            </button>
            <button type="button" class="btn btn-danger"
                    uib-tooltip="{{ 'CommonLabels.Delete' | translate }}" tooltip-placement="top" tooltip-animation="false" tooltip-trigger="'mouseenter'" tooltip-append-to-body="true"
                    ng-disabled="reportTemplate === null"
                    ng-click="removeReportTemplate(reportTemplate);">
                <span class="fa fa-trash"></span>
            </button>
        </div>
    </div>
</div>

<hr ng-if="$state.includes($state.current.data.onDemandState) && reportCategory.additionalFields.length > 0 && reportTemplateList.length > 0">
<!-- // Report Template -->

<!-- Shows all organizations -->
<div class="form-group" ng-if="isParamActive(reportCategory.additionalFields, 'orgId')">
    <label for="orgId" class="col-md-3">{{ 'Subsystems.Reporting.AdditionalParams.Organization' | translate }}</label>
    <div class="col-md-7">
        <select id="orgId" name="orgId" destroy-additional-field
                ng-model="$parent.additionalParams.orgId" class="form-control"
                ng-options="organization.id as organization.name for organization in organizationList">
            <option value="">{{ 'CommonLabels.All' | translate }}</option>
        </select>
    </div>
</div>

<div class="form-group" ng-if="isParamActive(reportCategory.additionalFields, 'organizationId')">
    <label for="organizationId" class="col-md-3">{{ 'Subsystems.Reporting.AdditionalParams.Organization' | translate }}</label>
    <div class="col-md-7">
        <select id="organizationId" name="organizationId" destroy-additional-field
                ng-model="$parent.additionalParams.organizationId" class="form-control"
                ng-options="organization.id as organization.name for organization in organizationList">
            <option value="">{{ 'CommonLabels.All' | translate }}</option>
        </select>
    </div>
</div>

<div class="form-group" ng-if="isParamActive(reportCategory.additionalFields, 'organizationIdMandatory')">
    <label for="organizationId" class="col-md-3">{{ 'Subsystems.Reporting.AdditionalParams.Organization' | translate }}</label>
    <div class="col-md-7">
        <select id="organizationId" name="organizationId" class="form-control" destroy-additional-field
                ng-model="$parent.additionalParams.organizationId"
                ng-required="true"
                ng-options="organization.id as organization.name for organization in organizationList">
            <option value="">-- {{ 'CommonLabels.SelectOne' | translate }} --</option>
        </select>
        <ul ng-class="{ 'parsley-error-list': form.organizationId.$dirty && form.organizationId.$invalid }"
            ng-show="form.organizationId.$dirty && form.organizationId.$invalid">
            <li class="required" ng-show="form.organizationId.$error.required">{{ 'CommonMessages.RequiredFieldError' | translate }}</li>
        </ul>
    </div>
</div>

<span ng-if="isParamActive(reportCategory.additionalFields, 'serviceId')">
    <div class="form-group" ng-if="$parent.additionalParams.organizationId">
        <label for="serviceId" class="col-md-3">{{ 'Subsystems.Reporting.AdditionalParams.Service' | translate }}</label>
        <div class="col-md-7">
            <select id="serviceId" name="serviceId" destroy-additional-field
                    ng-model="$parent.additionalParams.serviceId" class="form-control"
                    ng-options="service.id as service.name for service in (serviceList | ServiceByOrganizationFilter:$parent.additionalParams.organizationId)">
                <option value="">{{ 'CommonLabels.All' | translate }}</option>
            </select>
        </div>
    </div>
</span>

<!-- USSD Browser and Gateway Specific Fields -->
<div class="form-group" ng-if="isParamActive(reportCategory.additionalFields, 'webServicesNames')">
    <label for="appNames" class="col-md-3">{{ 'Subsystems.Reporting.AdditionalParams.AppName' | translate }}</label>
    <div class="col-md-7">
        <select id="appNames" name="appNames"
                destroy-additional-field
                ng-model="$parent.additionalParams.appNames" class="form-control"
                ng-options="ussdWebService.name as ussdWebService.name for ussdWebService in ussdWebServiceList">
            <option value="">{{ 'CommonLabels.All' | translate }}</option>
        </select>
    </div>
</div>
<!-- // USSD Browser and Gateway Specific Fields -->

<!-- SSM Specific Fields -->
<span ng-if="isParamActive(reportCategory.additionalFields, 'ssmServiceId')">
    <div class="form-group" ng-if="$parent.additionalParams.organizationId">
        <label for="ssmServiceId" class="col-md-3">{{ 'Subsystems.Reporting.AdditionalParams.Service' | translate }}</label>
        <div class="col-md-7">
            <select id="ssmServiceId" name="ssmServiceId"
                    destroy-additional-field
                    ng-model="$parent.additionalParams.serviceId" class="form-control"
                    ng-options="service.id as service.name for service in (serviceList | ServiceByOrganizationFilter:$parent.additionalParams.organizationId)">
                <option value="">{{ 'CommonLabels.All' | translate }}</option>
            </select>
        </div>
    </div>
</span>

<span ng-if="isParamActive(reportCategory.additionalFields, 'ssmOfferId')">
    <div class="form-group" ng-if="$parent.additionalParams.organizationId">
        <label for="ssmOfferId" class="col-md-3">{{ 'Subsystems.Reporting.AdditionalParams.Offer' | translate }}</label>
        <div class="col-md-7">
            <select id="ssmOfferId" name="ssmOfferId"
                    destroy-additional-field
                    ng-model="$parent.additionalParams.offerId" class="form-control"
                    ng-options="offer.id as offer.name for offer in (offerList | OfferByOrganizationFilter:$parent.additionalParams.organizationId)">
                <option value="">{{ 'CommonLabels.All' | translate }}</option>
            </select>
        </div>
    </div>
</span>

<span ng-if="isParamActive(reportCategory.additionalFields, 'contentType')">
    <div class="form-group">
        <label for="contentType" class="col-md-3">{{ 'Subsystems.Reporting.AdditionalParams.ContentType' | translate }}</label>
        <div class="col-md-7">
            <select id="contentType" name="contentType"
                    destroy-additional-field
                    ng-model="$parent.additionalParams.contentType" class="form-control"
                    ng-options="contentType as contentType for contentType in contentTypeList">
                <option value="">{{ 'CommonLabels.All' | translate }}</option>
            </select>
        </div>
    </div>
</span>

<span ng-if="isParamActive(reportCategory.additionalFields, 'dspchannel')">
    <div class="form-group">
        <label for="channel" class="col-md-3">{{ 'Subsystems.Reporting.AdditionalParams.Channel' | translate }}</label>
        <div class="col-md-7">
            <select id="channel" name="channel"
                    destroy-additional-field
                    ng-model="$parent.additionalParams.channel" class="form-control"
                    ng-options="channel.value as channel.text for channel in SUBSCRIPTION_MANAGEMENT_CHANNEL_TYPES">
                <option value="">{{ 'CommonLabels.All' | translate }}</option>
            </select>
        </div>
    </div>
</span>

<span ng-if="isParamActive(reportCategory.additionalFields, 'rbtchannel')">
    <div class="form-group">
        <label for="channel" class="col-md-3">{{ 'Subsystems.Reporting.AdditionalParams.Channel' | translate }}</label>
        <div class="col-md-7">
            <select id="channel" name="channel"
                    destroy-additional-field
                    ng-model="$parent.additionalParams.channel" class="form-control"
                    ng-options="channel.value as channel.text for channel in SUBSCRIPTION_MANAGEMENT_CHANNEL_TYPES_RBT">
                <option value="">{{ 'CommonLabels.All' | translate }}</option>
            </select>
        </div>
    </div>
</span>
<!-- // SSM Specific Fields -->

<!-- BMS Specific Fields -->
<div class="form-group" ng-if="isParamActive(reportCategory.additionalFields, 'organization') && isAdminUser">
    <label for="organization" class="col-md-3">{{ 'Subsystems.Reporting.AdditionalParams.Organization' | translate }}</label>
    <div class="col-md-7">
        <select id="organization" name="organization" destroy-additional-field
                ng-model="$parent.additionalParams.organization" class="form-control"
                ng-options="organization.name as organization.name for organization in organizationList">
            <option value="">{{ 'CommonLabels.All' | translate }}</option>
        </select>
    </div>
</div>

<div class="form-group" ng-if="isParamActive(reportCategory.additionalFields, 'user') && (isAdminUser || isBMSAdminUser)">
    <label for="user" class="col-md-3">{{ 'Subsystems.Reporting.AdditionalParams.User' | translate }}</label>
    <div class="col-md-7">
        <select id="user" name="user" class="form-control"
                destroy-additional-field
                ng-model="$parent.additionalParams.user"
                ng-options="userAccount.userName as userAccount.userName for userAccount in userAccountList">
            <option value="">{{ 'CommonLabels.All' | translate }}</option>
        </select>
    </div>
</div>

<div class="form-group" ng-if="isParamActive(reportCategory.additionalFields, 'campaignId')">
    <label for="campaignId" class="col-md-3">{{ 'Subsystems.Reporting.AdditionalParams.CampaignId' | translate }}</label>
    <div class="col-md-4">
        <input id="campaignId" name="campaignId" type="text" class="form-control input-sm"
               destroy-additional-field
               ng-model="$parent.additionalParams.campaignId"
               ng-maxlength="100"/>
        <ul ng-class="{ 'parsley-error-list': form.campaignId.$dirty && form.campaignId.$invalid }" ng-show="form.campaignId.$dirty && form.campaignId.$invalid">
            <li class="required" ng-show="form.campaignId.$error.maxlength">{{ 'CommonMessages.MaxLengthError' | translate:{max_length: 100} }}</li>
        </ul>
    </div>
</div>

<div class="form-group" ng-if="isParamActive(reportCategory.additionalFields, 'bmsId')">
    <label for="bmsId" class="col-md-3">{{ 'Subsystems.Reporting.AdditionalParams.CampaignId' | translate }}</label>
    <div class="col-md-4">
        <input id="bmsId" name="bmsId" type="text" class="form-control input-sm"
               destroy-additional-field
               ng-model="$parent.additionalParams.bmsId"
               ng-maxlength="100"/>
        <ul ng-class="{ 'parsley-error-list': form.bmsId.$dirty && form.bmsId.$invalid }" ng-show="form.bmsId.$dirty && form.bmsId.$invalid">
            <li class="required" ng-show="form.bmsId.$error.maxlength">{{ 'CommonMessages.MaxLengthError' | translate:{max_length: 100} }}</li>
        </ul>
    </div>
</div>
<!-- // BMS Specific Fields -->

<!-- API Manager Specific Fields -->
<div class="form-group" ng-if="isParamActive(reportCategory.additionalFields, 'endpoint')">
    <label for="endpoint" class="col-md-3">{{ 'Subsystems.Reporting.AdditionalParams.Endpoint' | translate }}</label>
    <div class="col-md-7">
        <select id="endpoint" name="endpoint" destroy-additional-field
                ng-model="$parent.additionalParams.endpoint" class="form-control"
                ng-options="endpoint.name as endpoint.name for endpoint in endpointList">
            <option value="">{{ 'CommonLabels.All' | translate }}</option>
        </select>
    </div>
</div>

<div class="form-group" ng-if="isParamActive(reportCategory.additionalFields, 'developerName')">
    <label for="developerName" class="col-md-3">{{ 'Subsystems.Reporting.AdditionalParams.Developer' | translate }}</label>
    <div class="col-md-7">
        <select id="developerName" name="developerName" destroy-additional-field
                ng-model="$parent.additionalParams.developerName" class="form-control"
                ng-options="dev.name as dev.name for dev in developerList"
                ng-change="getApplications(additionalParams.developerName)">
            <option value="">{{ 'CommonLabels.All' | translate }}</option>
        </select>
    </div>
</div>

<div class="form-group" ng-if="isParamActive(reportCategory.additionalFields, 'applicationName') && $parent.additionalParams.developerName">
    <label for="applicationName" class="col-md-3">{{ 'Subsystems.Reporting.AdditionalParams.Application' | translate }}</label>
    <div class="col-md-7">
        <select id="applicationName" name="applicationName" destroy-additional-field
                ng-model="$parent.additionalParams.applicationName" class="form-control"
                ng-options="application.name as application.name for application in applicationList">
            <option value="">{{ 'CommonLabels.All' | translate }}</option>
        </select>
    </div>
</div>

<div class="form-group" ng-if="isParamActive(reportCategory.additionalFields, 'apiName')">
    <label for="apiName" class="col-md-3">{{ 'Subsystems.Reporting.AdditionalParams.API' | translate }}</label>
    <div class="col-md-7">
        <select id="apiName" name="apiName" destroy-additional-field
                ng-model="$parent.api" class="form-control"
                ng-options="api as (api.apiName + ' - ' + api.versionName) for api in apiList"
                ng-change="setApiProperties(api)">
            <option value="">{{ 'CommonLabels.All' | translate }}</option>
        </select>
    </div>
</div>

<div class="form-group" ng-if="isParamActive(reportCategory.additionalFields, 'apiMethodName') && $parent.additionalParams.apiName">
    <label for="apiMethodName" class="col-md-3">{{ 'Subsystems.Reporting.AdditionalParams.Method' | translate }}</label>
    <div class="col-md-7">
        <select id="apiMethodName" name="apiMethodName" destroy-additional-field
                ng-model="$parent.additionalParams.apiMethodName" class="form-control"
                ng-options="method.name as method.name for method in apiList[$parent.api.index].methods">
            <option value="">{{ 'CommonLabels.All' | translate }}</option>
        </select>
    </div>
</div>

<div class="form-group" ng-if="isParamActive(reportCategory.additionalFields, 'offerName')">
    <label for="offerName" class="col-md-3">{{ 'Subsystems.Reporting.AdditionalParams.Offer' | translate }}</label>
    <div class="col-md-7">
        <select id="offerName" name="offerName" destroy-additional-field
                ng-model="$parent.additionalParams.offerName" class="form-control"
                ng-options="offer.name as offer.name for offer in offerList">
            <option value="">{{ 'CommonLabels.All' | translate }}</option>
        </select>
    </div>
</div>
<!-- // API Manager Specific Fields -->

<!-- Revenue Specific Fields -->
<div class="form-group" ng-if="isParamActive(reportCategory.additionalFields, 'businessType')">
    <label for="businessType" class="col-md-3">{{ 'Subsystems.Reporting.AdditionalParams.BusinessType' | translate }}</label>
    <div class="col-md-7">
        <select id="businessType" name="businessType" destroy-additional-field
                ng-model="$parent.additionalParams.businessType" class="form-control"
                ng-options="businessType.Name as businessType.Name for businessType in businessTypes">
            <option value="">{{ 'CommonLabels.All' | translate }}</option>
        </select>
    </div>
</div>

<div class="form-group" ng-if="isParamActive(reportCategory.additionalFields, 'topN')">
    <label for="topN" class="col-md-3">{{ 'Subsystems.Reporting.AdditionalParams.TopN' | translate }}</label>
    <div class="col-md-5">
        <input id="topN" name="topN" type="number" class="form-control" destroy-additional-field
               uib-tooltip="{{ 'Subsystems.Reporting.AdditionalParams.TopNPlaceholder' | translate }}" tooltip-placement="top-left" tooltip-animation="false" tooltip-trigger="'mouseenter'" tooltip-append-to-body="true"
               ng-model="$parent.additionalParams.topN"
               min="0" max="9999"/>
        <ul ng-class="{ 'parsley-error-list': form.topN.$dirty && form.topN.$invalid }"
            ng-show="form.topN.$dirty && form.topN.$invalid">
            <li class="required" ng-show="form.topN.$error.min">{{ 'CommonMessages.MinValueError' | translate:{ min: 0 } }}</li>
            <li class="required" ng-show="form.topN.$error.max">{{ 'CommonMessages.MaxValueError' | translate:{ max: 9999 } }}</li>
            <li class="required" ng-show="form.topN.$error.number">{{ 'CommonMessages.NumericFieldError' | translate }}</li>
        </ul>
    </div>
</div>
<!-- // Revenue Specific Fields -->
